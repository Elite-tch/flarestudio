{"version":3,"sources":["../src/core/networks.ts","../src/core/errors.ts","../src/modules/ftso/FTSOModule.ts","../src/modules/wallet/WalletModule.ts","../src/modules/utils/UtilsModule.ts","../src/modules/fdc/FDCModule.ts","../src/modules/staking/StakingModule.ts","../src/modules/fassets/FAssetsModule.ts","../src/modules/stateConnector/StateConnectorModule.ts","../src/core/FlareSDK.ts"],"names":["timer","formatEther","parseEther","CONTRACT_REGISTRY_ABI","Contract","formatUnits","JsonRpcProvider"],"mappings":"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","file":"index.mjs","sourcesContent":["import type { FlareNetwork, NetworkConfig } from '../types';\r\n\r\n/**\r\n * Network configurations for all supported Flare networks\r\n */\r\nexport const NETWORKS: Record<FlareNetwork, NetworkConfig> = {\r\n    flare: {\r\n        chainId: 14,\r\n        name: 'Flare Mainnet',\r\n        rpc: 'https://flare-api.flare.network/ext/C/rpc',\r\n        explorer: 'https://flare-explorer.flare.network',\r\n        testnet: false,\r\n    },\r\n    coston2: {\r\n        chainId: 114,\r\n        name: 'Coston2 Testnet',\r\n        rpc: 'https://coston2-api.flare.network/ext/C/rpc',\r\n        explorer: 'https://coston2-explorer.flare.network',\r\n        testnet: true,\r\n    },\r\n    songbird: {\r\n        chainId: 19,\r\n        name: 'Songbird Canary Network',\r\n        rpc: 'https://songbird-api.flare.network/ext/C/rpc',\r\n        explorer: 'https://songbird-explorer.flare.network',\r\n        testnet: false,\r\n    },\r\n    coston: {\r\n        chainId: 16,\r\n        name: 'Coston Testnet',\r\n        rpc: 'https://coston-api.flare.network/ext/C/rpc',\r\n        explorer: 'https://coston-explorer.flare.network',\r\n        testnet: true,\r\n    },\r\n};\r\n\r\n/**\r\n * Get network configuration by name\r\n */\r\nexport function getNetworkConfig(network: FlareNetwork): NetworkConfig {\r\n    return NETWORKS[network];\r\n}\r\n\r\n/**\r\n * Get network by chain ID\r\n */\r\nexport function getNetworkByChainId(chainId: number): FlareNetwork | undefined {\r\n    return Object.entries(NETWORKS).find(\r\n        ([_, config]) => config.chainId === chainId\r\n    )?.[0] as FlareNetwork | undefined;\r\n}\r\n","/**\r\n * Base error class for all SDK errors\r\n */\r\nexport class SDKError extends Error {\r\n    constructor(\r\n        message: string,\r\n        public code: string,\r\n        public details?: unknown\r\n    ) {\r\n        super(message);\r\n        this.name = 'SDKError';\r\n        Object.setPrototypeOf(this, SDKError.prototype);\r\n    }\r\n}\r\n\r\n/**\r\n * FTSO module errors\r\n */\r\nexport class FTSOError extends SDKError {\r\n    constructor(message: string, code: string, details?: unknown) {\r\n        super(message, code, details);\r\n        this.name = 'FTSOError';\r\n        Object.setPrototypeOf(this, FTSOError.prototype);\r\n    }\r\n}\r\n\r\n/**\r\n * FDC module errors\r\n */\r\nexport class FDCError extends SDKError {\r\n    constructor(message: string, code: string, details?: unknown) {\r\n        super(message, code, details);\r\n        this.name = 'FDCError';\r\n        Object.setPrototypeOf(this, FDCError.prototype);\r\n    }\r\n}\r\n\r\n/**\r\n * fAssets module errors\r\n */\r\nexport class FAssetsError extends SDKError {\r\n    constructor(message: string, code: string, details?: unknown) {\r\n        super(message, code, details);\r\n        this.name = 'FAssetsError';\r\n        Object.setPrototypeOf(this, FAssetsError.prototype);\r\n    }\r\n}\r\n\r\n/**\r\n * Wallet module errors\r\n */\r\nexport class WalletError extends SDKError {\r\n    constructor(message: string, code: string, details?: unknown) {\r\n        super(message, code, details);\r\n        this.name = 'WalletError';\r\n        Object.setPrototypeOf(this, WalletError.prototype);\r\n    }\r\n}\r\n\r\n/**\r\n * Staking module errors\r\n */\r\nexport class StakingError extends SDKError {\r\n    constructor(message: string, code: string, details?: unknown) {\r\n        super(message, code, details);\r\n        this.name = 'StakingError';\r\n        Object.setPrototypeOf(this, StakingError.prototype);\r\n    }\r\n}\r\n\r\n/**\r\n * State Connector module errors\r\n */\r\nexport class StateConnectorError extends SDKError {\r\n    constructor(message: string, code: string, details?: unknown) {\r\n        super(message, code, details);\r\n        this.name = 'StateConnectorError';\r\n        Object.setPrototypeOf(this, StateConnectorError.prototype);\r\n    }\r\n}\r\n\r\n/**\r\n * Error codes\r\n */\r\nexport const ErrorCodes = {\r\n    // General\r\n    INVALID_PARAMETER: 'INVALID_PARAMETER',\r\n    NETWORK_ERROR: 'NETWORK_ERROR',\r\n    NOT_INITIALIZED: 'NOT_INITIALIZED',\r\n\r\n    // FTSO\r\n    SYMBOL_NOT_FOUND: 'SYMBOL_NOT_FOUND',\r\n    PRICE_NOT_AVAILABLE: 'PRICE_NOT_AVAILABLE',\r\n    INVALID_TIME_RANGE: 'INVALID_TIME_RANGE',\r\n\r\n    // FDC\r\n    ATTESTATION_NOT_FOUND: 'ATTESTATION_NOT_FOUND',\r\n    VERIFICATION_FAILED: 'VERIFICATION_FAILED',\r\n    INVALID_PROOF: 'INVALID_PROOF',\r\n\r\n    // fAssets\r\n    ASSET_NOT_SUPPORTED: 'ASSET_NOT_SUPPORTED',\r\n    INSUFFICIENT_COLLATERAL: 'INSUFFICIENT_COLLATERAL',\r\n    MINTING_FAILED: 'MINTING_FAILED',\r\n    REDEMPTION_FAILED: 'REDEMPTION_FAILED',\r\n\r\n    // Wallet\r\n    WALLET_NOT_CONNECTED: 'WALLET_NOT_CONNECTED',\r\n    INSUFFICIENT_FUNDS: 'INSUFFICIENT_FUNDS',\r\n    TRANSACTION_FAILED: 'TRANSACTION_FAILED',\r\n    SIGNATURE_REJECTED: 'SIGNATURE_REJECTED',\r\n\r\n    // Staking\r\n    DELEGATION_FAILED: 'DELEGATION_FAILED',\r\n    CLAIM_FAILED: 'CLAIM_FAILED',\r\n    PROVIDER_NOT_FOUND: 'PROVIDER_NOT_FOUND',\r\n    NO_REWARDS: 'NO_REWARDS',\r\n    INVALID_PARAMS: 'INVALID_PARAMS',\r\n\r\n    // State Connector\r\n    PROOF_VERIFICATION_FAILED: 'PROOF_VERIFICATION_FAILED',\r\n    INVALID_ATTESTATION_TYPE: 'INVALID_ATTESTATION_TYPE',\r\n} as const;\r\n","import { Contract, JsonRpcProvider } from 'ethers';\r\nimport type { FTSOPrice, CacheOptions, PriceCallback, UnsubscribeFunction } from '../../types';\r\nimport { FTSOError, ErrorCodes } from '../../core/errors';\r\n\r\nconst CONTRACT_REGISTRY_ABI = [\r\n    'function getContractAddressByName(string memory _name) external view returns (address)',\r\n];\r\n\r\nconst FTSO_REGISTRY_ABI = [\r\n    'function getCurrentPriceWithDecimals(string memory _symbol) external view returns (uint256 _price, uint256 _timestamp, uint256 _assetPriceUsdDecimals)',\r\n    'function getSupportedSymbols() external view returns (string[] memory _supportedSymbols)',\r\n];\r\n\r\nexport class FTSOModule {\r\n    private provider: JsonRpcProvider;\r\n    private contractRegistryAddress: string;\r\n    private ftsoRegistryAddressPromise: Promise<string> | null = null;\r\n    private cache: Map<string, { price: FTSOPrice; timestamp: number }> = new Map();\r\n    private cacheTTL: number;\r\n    private subscriptions: Map<string, NodeJS.Timeout> = new Map();\r\n\r\n    constructor(provider: JsonRpcProvider, network: string, cacheTTL = 60) {\r\n        this.provider = provider;\r\n        this.cacheTTL = cacheTTL * 1000; // Convert to milliseconds\r\n\r\n        // FlareContractRegistry addresses (same for all networks)\r\n        const contractRegistryAddresses: Record<string, string> = {\r\n            flare: '0xaD67FE66660Fb8dFE9d6b1b4240d8650e30F6019',\r\n            coston2: '0xaD67FE66660Fb8dFE9d6b1b4240d8650e30F6019',\r\n            songbird: '0xaD67FE66660Fb8dFE9d6b1b4240d8650e30F6019',\r\n            coston: '0xaD67FE66660Fb8dFE9d6b1b4240d8650e30F6019',\r\n        };\r\n\r\n        this.contractRegistryAddress = contractRegistryAddresses[network];\r\n\r\n        if (!this.contractRegistryAddress) {\r\n            throw new FTSOError(\r\n                `Unsupported network: ${network}`,\r\n                ErrorCodes.NETWORK_ERROR\r\n            );\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get the FTSO Registry address from the Contract Registry\r\n     */\r\n    private async getFtsoRegistryAddress(): Promise<string> {\r\n        if (!this.ftsoRegistryAddressPromise) {\r\n            this.ftsoRegistryAddressPromise = (async () => {\r\n                try {\r\n                    const contractRegistry = new Contract(\r\n                        this.contractRegistryAddress,\r\n                        CONTRACT_REGISTRY_ABI,\r\n                        this.provider\r\n                    );\r\n\r\n                    // Get the FtsoRegistry contract address\r\n                    const address = await contractRegistry.getContractAddressByName('FtsoRegistry');\r\n                    return address;\r\n                } catch (error: any) {\r\n                    // Reset the promise on error so it can be retried\r\n                    this.ftsoRegistryAddressPromise = null;\r\n                    throw new FTSOError(\r\n                        `Failed to get FTSO Registry address: ${error.message}`,\r\n                        ErrorCodes.NETWORK_ERROR,\r\n                        error\r\n                    );\r\n                }\r\n            })();\r\n        }\r\n\r\n        return this.ftsoRegistryAddressPromise;\r\n    }\r\n\r\n    /**\r\n     * Get current price for a single asset\r\n     */\r\n    async getPrice(symbol: string, options: CacheOptions = {}): Promise<FTSOPrice> {\r\n        const cacheEnabled = options.cache ?? true;\r\n        const ttl = options.ttl ? options.ttl * 1000 : this.cacheTTL;\r\n\r\n        // Check cache\r\n        if (cacheEnabled) {\r\n            const cached = this.cache.get(symbol);\r\n            if (cached && Date.now() - cached.timestamp < ttl) {\r\n                return cached.price;\r\n            }\r\n        }\r\n\r\n        try {\r\n            const registryAddress = await this.getFtsoRegistryAddress();\r\n            const registry = new Contract(\r\n                registryAddress,\r\n                FTSO_REGISTRY_ABI,\r\n                this.provider\r\n            );\r\n\r\n            const [price, timestamp, decimals] = await registry.getCurrentPriceWithDecimals(symbol);\r\n\r\n            const priceData: FTSOPrice = {\r\n                symbol,\r\n                price: Number(price) / Math.pow(10, Number(decimals)),\r\n                timestamp: new Date(Number(timestamp) * 1000),\r\n                decimals: Number(decimals),\r\n                rawPrice: price.toString(),\r\n            };\r\n\r\n            // Update cache\r\n            if (cacheEnabled) {\r\n                this.cache.set(symbol, { price: priceData, timestamp: Date.now() });\r\n            }\r\n\r\n            return priceData;\r\n        } catch (error: any) {\r\n            throw new FTSOError(\r\n                `Failed to fetch price for ${symbol}: ${error.message}`,\r\n                ErrorCodes.PRICE_NOT_AVAILABLE,\r\n                error\r\n            );\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get current prices for multiple assets\r\n     */\r\n    async getPrices(symbols: string[], options: CacheOptions = {}): Promise<FTSOPrice[]> {\r\n        const pricePromises = symbols.map(symbol => this.getPrice(symbol, options));\r\n        return Promise.all(pricePromises);\r\n    }\r\n\r\n    /**\r\n     * Get list of supported symbols\r\n     */\r\n    async getSupportedSymbols(): Promise<string[]> {\r\n        try {\r\n            const registryAddress = await this.getFtsoRegistryAddress();\r\n            const registry = new Contract(\r\n                registryAddress,\r\n                FTSO_REGISTRY_ABI,\r\n                this.provider\r\n            );\r\n\r\n            const symbols = await registry.getSupportedSymbols();\r\n            return symbols;\r\n        } catch (error: any) {\r\n            throw new FTSOError(\r\n                `Failed to fetch supported symbols: ${error.message}`,\r\n                ErrorCodes.NETWORK_ERROR,\r\n                error\r\n            );\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Subscribe to price updates (polling-based)\r\n     */\r\n    subscribe(symbol: string, callback: PriceCallback, interval = 5000): UnsubscribeFunction {\r\n        // Initial fetch\r\n        this.getPrice(symbol, { cache: false }).then(callback).catch(console.error);\r\n\r\n        // Set up polling\r\n        const timer = setInterval(async () => {\r\n            try {\r\n                const price = await this.getPrice(symbol, { cache: false });\r\n                callback(price);\r\n            } catch (error) {\r\n                console.error(`Subscription error for ${symbol}:`, error);\r\n            }\r\n        }, interval);\r\n\r\n        this.subscriptions.set(symbol, timer);\r\n\r\n        // Return unsubscribe function\r\n        return () => {\r\n            const timer = this.subscriptions.get(symbol);\r\n            if (timer) {\r\n                clearInterval(timer);\r\n                this.subscriptions.delete(symbol);\r\n            }\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Clear all cached prices\r\n     */\r\n    clearCache(): void {\r\n        this.cache.clear();\r\n    }\r\n\r\n    /**\r\n     * Cleanup all subscriptions\r\n     */\r\n    cleanup(): void {\r\n        this.subscriptions.forEach(timer => clearInterval(timer));\r\n        this.subscriptions.clear();\r\n        this.cache.clear();\r\n    }\r\n}\r\n","import { BrowserProvider, JsonRpcSigner, formatEther, parseEther, TransactionResponse, TransactionRequest } from 'ethers';\r\nimport { WalletError, ErrorCodes } from '../../core/errors';\r\nimport { WalletBalance, TransactionOptions } from '../../types';\r\n\r\n/**\r\n * Wallet Module\r\n * Utility functions for wallet interaction and transaction management\r\n */\r\nexport class WalletModule {\r\n    private provider: BrowserProvider | null = null;\r\n    private signer: JsonRpcSigner | null = null;\r\n\r\n    constructor() { }\r\n\r\n    /**\r\n     * Connect to a wallet (e.g., MetaMask)\r\n     * @param provider - The EIP-1193 provider (e.g., window.ethereum)\r\n     */\r\n    async connect(provider: any): Promise<string> {\r\n        try {\r\n            this.provider = new BrowserProvider(provider);\r\n            this.signer = await this.provider.getSigner();\r\n            const address = await this.signer.getAddress();\r\n            return address;\r\n        } catch (error: any) {\r\n            throw new WalletError(\r\n                `Failed to connect wallet: ${error.message}`,\r\n                ErrorCodes.WALLET_NOT_CONNECTED,\r\n                error\r\n            );\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get the connected wallet address\r\n     */\r\n    async getAddress(): Promise<string> {\r\n        this.ensureConnected();\r\n        return await this.signer!.getAddress();\r\n    }\r\n\r\n    /**\r\n     * Get the balance of the connected wallet\r\n     */\r\n    async getBalance(): Promise<WalletBalance> {\r\n        this.ensureConnected();\r\n        try {\r\n            const balance = await this.provider!.getBalance(await this.signer!.getAddress());\r\n            return {\r\n                flr: formatEther(balance),\r\n                // wflr: TODO: Implement wrapped FLR balance fetching\r\n            };\r\n        } catch (error: any) {\r\n            throw new WalletError(\r\n                `Failed to get balance: ${error.message}`,\r\n                ErrorCodes.NETWORK_ERROR,\r\n                error\r\n            );\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Send a transaction\r\n     */\r\n    async send(options: TransactionOptions): Promise<TransactionResponse> {\r\n        this.ensureConnected();\r\n        try {\r\n            const tx: TransactionRequest = {\r\n                to: options.to,\r\n                value: options.value ? parseEther(options.value) : undefined,\r\n                data: options.data,\r\n            };\r\n\r\n            return await this.signer!.sendTransaction(tx);\r\n        } catch (error: any) {\r\n            throw new WalletError(\r\n                `Transaction failed: ${error.message}`,\r\n                ErrorCodes.TRANSACTION_FAILED,\r\n                error\r\n            );\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Sign a message\r\n     */\r\n    async signMessage(message: string): Promise<string> {\r\n        this.ensureConnected();\r\n        try {\r\n            return await this.signer!.signMessage(message);\r\n        } catch (error: any) {\r\n            throw new WalletError(\r\n                `Signing failed: ${error.message}`,\r\n                ErrorCodes.SIGNATURE_REJECTED,\r\n                error\r\n            );\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Check if wallet is connected\r\n     */\r\n    isConnected(): boolean {\r\n        return !!this.signer;\r\n    }\r\n\r\n    /**\r\n     * Ensure wallet is connected\r\n     */\r\n    private ensureConnected(): void {\r\n        if (!this.signer || !this.provider) {\r\n            throw new WalletError(\r\n                'Wallet not connected',\r\n                ErrorCodes.WALLET_NOT_CONNECTED\r\n            );\r\n        }\r\n    }\r\n}\r\n","import { formatEther, parseEther, formatUnits, parseUnits, isAddress, getAddress } from 'ethers';\r\nimport { SDKError } from '../../core/errors';\r\n\r\n/**\r\n * Utils Module\r\n * Helper utilities for common blockchain operations\r\n */\r\nexport class UtilsModule {\r\n    private cacheStore: Map<string, { value: any; expires: number }> = new Map();\r\n\r\n    constructor() { }\r\n\r\n    /**\r\n     * Convert Wei to Ether\r\n     */\r\n    fromWei(wei: string | bigint): string {\r\n        return formatEther(wei);\r\n    }\r\n\r\n    /**\r\n     * Convert Ether to Wei\r\n     */\r\n    toWei(ether: string): bigint {\r\n        return parseEther(ether);\r\n    }\r\n\r\n    /**\r\n     * Convert value to specific decimals\r\n     */\r\n    toDecimals(value: string, decimals: number): bigint {\r\n        return parseUnits(value, decimals);\r\n    }\r\n\r\n    /**\r\n     * Convert value from specific decimals\r\n     */\r\n    fromDecimals(value: string | bigint, decimals: number): string {\r\n        return formatUnits(value, decimals);\r\n    }\r\n\r\n    /**\r\n     * Validate an address\r\n     */\r\n    isValidAddress(address: string): boolean {\r\n        return isAddress(address);\r\n    }\r\n\r\n    /**\r\n     * Get checksum address\r\n     */\r\n    toChecksumAddress(address: string): string {\r\n        try {\r\n            return getAddress(address);\r\n        } catch (error) {\r\n            throw new Error(`Invalid address: ${address}`);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Format error object\r\n     */\r\n    formatError(error: any): { code: string; message: string; details?: any } {\r\n        if (error instanceof SDKError) {\r\n            return {\r\n                code: error.code,\r\n                message: error.message,\r\n                details: error.details,\r\n            };\r\n        }\r\n\r\n        return {\r\n            code: 'UNKNOWN_ERROR',\r\n            message: error.message || 'An unknown error occurred',\r\n            details: error,\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Cache utilities\r\n     */\r\n    cache = {\r\n        set: (key: string, value: any, ttlSeconds: number): void => {\r\n            this.cacheStore.set(key, {\r\n                value,\r\n                expires: Date.now() + ttlSeconds * 1000,\r\n            });\r\n        },\r\n\r\n        get: (key: string): any | null => {\r\n            const item = this.cacheStore.get(key);\r\n            if (!item) return null;\r\n\r\n            if (Date.now() > item.expires) {\r\n                this.cacheStore.delete(key);\r\n                return null;\r\n            }\r\n\r\n            return item.value;\r\n        },\r\n\r\n        clear: (): void => {\r\n            this.cacheStore.clear();\r\n        },\r\n    };\r\n}\r\n","import { JsonRpcProvider, Contract } from 'ethers';\r\nimport { FDCError, ErrorCodes } from '../../core/errors';\r\nimport { Attestation } from '../../types';\r\n\r\n// Simplified ABI for FDC / State Connector interactions\r\n// Note: In a real implementation, this would use the full ABI from @flarenetwork/flare-periphery-contract-artifacts\r\nconst FDC_HUB_ABI = [\r\n    'function getAttestation(bytes32 _merkleRoot) external view returns (bool)',\r\n    'event AttestationRequest(uint256 timestamp, bytes data)',\r\n];\r\n\r\n/**\r\n * FDC Module\r\n * Verify events and data from other blockchains using Flare Data Connector\r\n */\r\nexport class FDCModule {\r\n    private provider: JsonRpcProvider;\r\n    private fdcHubAddress: string;\r\n    private subscriptions: Map<string, NodeJS.Timeout> = new Map();\r\n\r\n    constructor(provider: JsonRpcProvider, network: string) {\r\n        this.provider = provider;\r\n\r\n        // FDC Hub addresses (Mock addresses for now as they vary by network/deployment)\r\n        const fdcAddresses: Record<string, string> = {\r\n            flare: '0x5d462E308003D03576C44961dD9777f9B5490000', // Placeholder\r\n            coston2: '0x5d462E308003D03576C44961dD9777f9B5490000', // Placeholder\r\n            songbird: '0x5d462E308003D03576C44961dD9777f9B5490000', // Placeholder\r\n            coston: '0x5d462E308003D03576C44961dD9777f9B5490000', // Placeholder\r\n        };\r\n\r\n        this.fdcHubAddress = fdcAddresses[network];\r\n    }\r\n\r\n    /**\r\n     * Verify a Bitcoin payment\r\n     * @param params Payment details to verify\r\n     */\r\n    async verifyBitcoinPayment(params: {\r\n        txHash: string;\r\n        sourceAddress: string;\r\n        destinationAddress: string;\r\n        amount: number;\r\n    }): Promise<{ verified: boolean; blockNumber?: number; timestamp?: Date }> {\r\n        // In a real implementation, this would:\r\n        // 1. Construct the attestation request\r\n        // 2. Submit it to the FDC\r\n        // 3. Wait for the round to finalize\r\n        // 4. Check if the attestation was verified\r\n\r\n        // Simulating verification for MVP\r\n        console.log('Verifying Bitcoin payment:', params);\r\n\r\n        // Mock delay\r\n        await new Promise(resolve => setTimeout(resolve, 1000));\r\n\r\n        return {\r\n            verified: true,\r\n            blockNumber: 123456,\r\n            timestamp: new Date(),\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Verify an attestation by ID (Merkle Root)\r\n     */\r\n    async verifyAttestation(attestationId: string): Promise<Attestation> {\r\n        try {\r\n            // Mock implementation\r\n            return {\r\n                id: attestationId,\r\n                type: 'Payment',\r\n                status: 'success',\r\n                blockNumber: 100000,\r\n                timestamp: new Date(),\r\n                data: { verified: true }\r\n            };\r\n        } catch (error: any) {\r\n            throw new FDCError(\r\n                `Failed to verify attestation: ${error.message}`,\r\n                ErrorCodes.VERIFICATION_FAILED,\r\n                error\r\n            );\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get recent attestations\r\n     */\r\n    async getRecentAttestations(options: {\r\n        type?: string;\r\n        limit?: number;\r\n        fromBlock?: number;\r\n    } = {}): Promise<Attestation[]> {\r\n        // Mock implementation\r\n        return [\r\n            {\r\n                id: '0x123...',\r\n                type: options.type || 'Payment',\r\n                status: 'success',\r\n                blockNumber: 100000,\r\n                timestamp: new Date(),\r\n            },\r\n            {\r\n                id: '0x456...',\r\n                type: options.type || 'Balance',\r\n                status: 'pending',\r\n                blockNumber: 100001,\r\n                timestamp: new Date(),\r\n            }\r\n        ];\r\n    }\r\n\r\n    /**\r\n     * Subscribe to new attestations\r\n     */\r\n    subscribe(type: string, callback: (attestation: Attestation) => void): () => void {\r\n        const timer = setInterval(() => {\r\n            // Mock new attestation\r\n            const mockAttestation: Attestation = {\r\n                id: `0x${Date.now().toString(16)}`,\r\n                type,\r\n                status: 'success',\r\n                blockNumber: 100002,\r\n                timestamp: new Date(),\r\n            };\r\n            callback(mockAttestation);\r\n        }, 10000); // Every 10 seconds\r\n\r\n        this.subscriptions.set(type, timer);\r\n\r\n        return () => {\r\n            clearInterval(timer);\r\n            this.subscriptions.delete(type);\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Cleanup subscriptions\r\n     */\r\n    cleanup(): void {\r\n        this.subscriptions.forEach(timer => clearInterval(timer));\r\n        this.subscriptions.clear();\r\n    }\r\n}\r\n","import { Contract, JsonRpcProvider, parseEther, formatEther } from 'ethers';\r\nimport { StakingError, ErrorCodes } from '../../core/errors';\r\nimport type { DelegationInfo, RewardInfo, ProviderStats } from '../../types';\r\n\r\n// WNat (Wrapped Native Token) ABI\r\nconst WNAT_ABI = [\r\n    'function deposit() payable',\r\n    'function withdraw(uint256 amount)',\r\n    'function balanceOf(address) view returns (uint256)',\r\n    'function delegate(address to, uint256 bips)',\r\n    'function delegatesOf(address owner) view returns (address[] memory, uint256[] memory)',\r\n    'function undelegateAll()',\r\n    'function votePowerOf(address owner) view returns (uint256)',\r\n];\r\n\r\n// FlareContractRegistry ABI\r\nconst CONTRACT_REGISTRY_ABI = [\r\n    'function getContractAddressByName(string memory _name) external view returns (address)',\r\n];\r\n\r\n// FtsoRewardManager ABI\r\nconst REWARD_MANAGER_ABI = [\r\n    'function claimReward(address payable recipient, uint256[] memory epochs) returns (uint256)',\r\n    'function getEpochsWithUnclaimedRewards(address beneficiary) view returns (uint256[] memory)',\r\n    'function getStateOfRewards(address beneficiary, uint256 rewardEpoch) view returns (address[] memory, uint256[] memory, bool[] memory, bool)',\r\n    'function getUnclaimedReward(uint256 epoch, address beneficiary) view returns (uint256)',\r\n];\r\n\r\n/**\r\n * Staking Module\r\n * Wrap FLR, delegate to FTSO providers, and claim rewards\r\n */\r\nexport class StakingModule {\r\n    private provider: JsonRpcProvider;\r\n    private network: string;\r\n    private wnatAddress: string;\r\n    private contractRegistryAddress: string;\r\n    private rewardManagerAddress: string | null = null;\r\n\r\n    constructor(provider: JsonRpcProvider, network: string) {\r\n        this.provider = provider;\r\n        this.network = network;\r\n\r\n        // WNat addresses for each network\r\n        const wnatAddresses: Record<string, string> = {\r\n            flare: '0x1D80c49BbBCd1C0911346656B529DF9E5c2F783d',\r\n            coston2: '0xC67DCE33D7A8efA5FfEB961899C73fe01bCe9273',\r\n            songbird: '0x02f0826ef6aD107Cfc861152B32B52fD11BaB9ED',\r\n            coston: '0x767b25A658E8FC8ab6eBbd52043495dB61b4ea91',\r\n        };\r\n\r\n        // FlareContractRegistry (same for all networks)\r\n        this.contractRegistryAddress = '0xaD67FE66660Fb8dFE9d6b1b4240d8650e30F6019';\r\n\r\n        this.wnatAddress = wnatAddresses[network];\r\n\r\n        if (!this.wnatAddress) {\r\n            throw new StakingError(\r\n                `Unsupported network: ${network}`,\r\n                ErrorCodes.NETWORK_ERROR\r\n            );\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get the FtsoRewardManager address from the Contract Registry\r\n     */\r\n    private async getRewardManagerAddress(): Promise<string> {\r\n        if (this.rewardManagerAddress) {\r\n            return this.rewardManagerAddress;\r\n        }\r\n\r\n        try {\r\n            const contractRegistry = new Contract(\r\n                this.contractRegistryAddress,\r\n                CONTRACT_REGISTRY_ABI,\r\n                this.provider\r\n            );\r\n\r\n            this.rewardManagerAddress = String(await contractRegistry.getContractAddressByName('FtsoRewardManager'));\r\n            return this.rewardManagerAddress;\r\n        } catch (error: any) {\r\n            throw new StakingError(\r\n                `Failed to get FtsoRewardManager address: ${error.message}`,\r\n                ErrorCodes.NETWORK_ERROR,\r\n                error\r\n            );\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Wrap native FLR/SGB to WFLR/WSGB\r\n     * @param amount Amount to wrap in FLR/SGB\r\n     * @param signer Wallet signer (must be connected)\r\n     */\r\n    async wrap(amount: string, signer: any): Promise<any> {\r\n        try {\r\n            const wnat = new Contract(this.wnatAddress, WNAT_ABI, signer);\r\n            const tx = await wnat.deposit({ value: parseEther(amount) });\r\n            return tx;\r\n        } catch (error: any) {\r\n            let message = error.message;\r\n            if (error.message.includes('Failed to fetch') || error.code === -32603) {\r\n                message = 'Network error: Please check your MetaMask connection and RPC URL.';\r\n            }\r\n\r\n            throw new StakingError(\r\n                `Failed to wrap tokens: ${message}`,\r\n                ErrorCodes.TRANSACTION_FAILED,\r\n                error\r\n            );\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Unwrap WFLR/WSGB to native FLR/SGB\r\n     * @param amount Amount to unwrap in WFLR/WSGB\r\n     * @param signer Wallet signer (must be connected)\r\n     */\r\n    async unwrap(amount: string, signer: any): Promise<any> {\r\n        try {\r\n            const wnat = new Contract(this.wnatAddress, WNAT_ABI, signer);\r\n            const tx = await wnat.withdraw(parseEther(amount));\r\n            return tx;\r\n        } catch (error: any) {\r\n            let message = error.message;\r\n            if (error.message.includes('Failed to fetch') || error.code === -32603) {\r\n                message = 'Network error: Please check your MetaMask connection and RPC URL.';\r\n            }\r\n\r\n            throw new StakingError(\r\n                `Failed to unwrap tokens: ${message}`,\r\n                ErrorCodes.TRANSACTION_FAILED,\r\n                error\r\n            );\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get WFLR/WSGB balance\r\n     * @param address Wallet address\r\n     */\r\n    async getWNatBalance(address: string): Promise<string> {\r\n        try {\r\n            const wnat = new Contract(this.wnatAddress, WNAT_ABI, this.provider);\r\n            const balance = await wnat.balanceOf(address);\r\n            return formatEther(balance);\r\n        } catch (error: any) {\r\n            throw new StakingError(\r\n                `Failed to get WNat balance: ${error.message}`,\r\n                ErrorCodes.NETWORK_ERROR,\r\n                error\r\n            );\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get vote power (delegatable amount)\r\n     * @param address Wallet address\r\n     */\r\n    async getVotePower(address: string): Promise<string> {\r\n        try {\r\n            const wnat = new Contract(this.wnatAddress, WNAT_ABI, this.provider);\r\n            const votePower = await wnat.votePowerOf(address);\r\n            return formatEther(votePower);\r\n        } catch (error: any) {\r\n            throw new StakingError(\r\n                `Failed to get vote power: ${error.message}`,\r\n                ErrorCodes.NETWORK_ERROR,\r\n                error\r\n            );\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Delegate vote power to a provider\r\n     * @param providerAddress FTSO provider address\r\n     * @param percentage Percentage to delegate (0-100)\r\n     * @param signer Wallet signer (must be connected)\r\n     */\r\n    async delegate(providerAddress: string, percentage: number, signer: any): Promise<any> {\r\n        if (percentage < 0 || percentage > 100) {\r\n            throw new StakingError(\r\n                'Percentage must be between 0 and 100',\r\n                ErrorCodes.INVALID_PARAMS\r\n            );\r\n        }\r\n\r\n        try {\r\n            const wnat = new Contract(this.wnatAddress, WNAT_ABI, signer);\r\n            const bips = percentage * 100; // Convert percentage to basis points (10000 = 100%)\r\n            const tx = await wnat.delegate(providerAddress, bips);\r\n            return tx;\r\n        } catch (error: any) {\r\n            let message = error.message;\r\n            if (error.message.includes('Failed to fetch') || error.code === -32603) {\r\n                message = 'Network error: Please check your MetaMask connection and RPC URL.';\r\n            }\r\n\r\n            throw new StakingError(\r\n                `Failed to delegate: ${message}`,\r\n                ErrorCodes.TRANSACTION_FAILED,\r\n                error\r\n            );\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Undelegate all vote power\r\n     * @param signer Wallet signer (must be connected)\r\n     */\r\n    async undelegateAll(signer: any): Promise<any> {\r\n        try {\r\n            const wnat = new Contract(this.wnatAddress, WNAT_ABI, signer);\r\n            const tx = await wnat.undelegateAll();\r\n            return tx;\r\n        } catch (error: any) {\r\n            let message = error.message;\r\n            if (error.message.includes('Failed to fetch') || error.code === -32603) {\r\n                message = 'Network error: Please check your MetaMask connection and RPC URL.';\r\n            }\r\n\r\n            throw new StakingError(\r\n                `Failed to undelegate: ${message}`,\r\n                ErrorCodes.TRANSACTION_FAILED,\r\n                error\r\n            );\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get current delegations\r\n     * @param address Wallet address\r\n     */\r\n    async getDelegations(address: string): Promise<DelegationInfo[]> {\r\n        try {\r\n            const wnat = new Contract(this.wnatAddress, WNAT_ABI, this.provider);\r\n            const [providers, percentages] = await wnat.delegatesOf(address);\r\n\r\n            return providers.map((provider: string, index: number) => ({\r\n                provider,\r\n                percentage: Number(percentages[index]) / 100, // Convert bips to percentage\r\n                amount: '0', // Would need to calculate based on total vote power\r\n            }));\r\n        } catch (error: any) {\r\n            throw new StakingError(\r\n                `Failed to get delegations: ${error.message}`,\r\n                ErrorCodes.NETWORK_ERROR,\r\n                error\r\n            );\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get unclaimed reward epochs\r\n     * @param address Wallet address\r\n     */\r\n    async getUnclaimedEpochs(address: string): Promise<number[]> {\r\n        try {\r\n            const rewardManagerAddress = await this.getRewardManagerAddress();\r\n            const rewardManager = new Contract(\r\n                rewardManagerAddress,\r\n                REWARD_MANAGER_ABI,\r\n                this.provider\r\n            );\r\n\r\n            const epochs = await rewardManager.getEpochsWithUnclaimedRewards(address);\r\n            return epochs.map((epoch: any) => Number(epoch));\r\n        } catch (error: any) {\r\n            throw new StakingError(\r\n                `Failed to get unclaimed epochs: ${error.message}`,\r\n                ErrorCodes.NETWORK_ERROR,\r\n                error\r\n            );\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get unclaimed reward amount for a specific epoch\r\n     * @param address Wallet address\r\n     * @param epoch Reward epoch number\r\n     */\r\n    async getUnclaimedReward(address: string, epoch: number): Promise<string> {\r\n        try {\r\n            const rewardManagerAddress = await this.getRewardManagerAddress();\r\n            const rewardManager = new Contract(\r\n                rewardManagerAddress,\r\n                REWARD_MANAGER_ABI,\r\n                this.provider\r\n            );\r\n\r\n            // getStateOfRewards returns:\r\n            // 0: address[] _dataProviders\r\n            // 1: uint256[] _rewardAmounts\r\n            // 2: bool[] _claimed\r\n            // 3: bool _claimable\r\n            const state = await rewardManager.getStateOfRewards(address, epoch);\r\n\r\n            const amounts = state[1];\r\n            const claimed = state[2];\r\n\r\n            let totalReward = BigInt(0);\r\n\r\n            for (let i = 0; i < amounts.length; i++) {\r\n                if (!claimed[i]) {\r\n                    totalReward += amounts[i];\r\n                }\r\n            }\r\n\r\n            return formatEther(totalReward);\r\n        } catch (error: any) {\r\n            throw new StakingError(\r\n                `Failed to get unclaimed reward: ${error.message}`,\r\n                ErrorCodes.NETWORK_ERROR,\r\n                error\r\n            );\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Claim rewards for specific epochs\r\n     * @param epochs Array of epoch numbers to claim (leave empty for all unclaimed)\r\n     * @param signer Wallet signer (must be connected)\r\n     */\r\n    async claimRewards(epochs: number[] | undefined, signer: any): Promise<any> {\r\n        try {\r\n            const address = await signer.getAddress();\r\n            const rewardManagerAddress = await this.getRewardManagerAddress();\r\n            const rewardManager = new Contract(\r\n                rewardManagerAddress,\r\n                REWARD_MANAGER_ABI,\r\n                signer\r\n            );\r\n\r\n            // If no epochs specified, get all unclaimed epochs\r\n            const epochsToClaim = epochs || await this.getUnclaimedEpochs(address);\r\n\r\n            if (epochsToClaim.length === 0) {\r\n                throw new StakingError(\r\n                    'No unclaimed rewards available',\r\n                    ErrorCodes.NO_REWARDS\r\n                );\r\n            }\r\n\r\n            const tx = await rewardManager.claimReward(address, epochsToClaim);\r\n            return tx;\r\n        } catch (error: any) {\r\n            let message = error.message;\r\n            if (error.message.includes('Failed to fetch') || error.code === -32603) {\r\n                message = 'Network error: Please check your MetaMask connection and RPC URL.';\r\n            }\r\n\r\n            throw new StakingError(\r\n                `Failed to claim rewards: ${message}`,\r\n                ErrorCodes.TRANSACTION_FAILED,\r\n                error\r\n            );\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get rewards history (claimed and unclaimed)\r\n     * @param address Wallet address\r\n     */\r\n    async getRewardsHistory(address: string): Promise<RewardInfo[]> {\r\n        try {\r\n            const unclaimedEpochs = await this.getUnclaimedEpochs(address);\r\n            // Note: This only gets unclaimed. For full history including claimed, \r\n            // we would need an indexer or event logs.\r\n\r\n            const rewards: RewardInfo[] = [];\r\n\r\n            for (const epoch of unclaimedEpochs) {\r\n                const amount = await this.getUnclaimedReward(address, epoch);\r\n                rewards.push({\r\n                    epoch,\r\n                    amount,\r\n                    claimed: false,\r\n                    timestamp: new Date(), // Would need to calculate actual timestamp\r\n                });\r\n            }\r\n\r\n            return rewards;\r\n        } catch (error: any) {\r\n            throw new StakingError(\r\n                `Failed to get rewards history: ${error.message}`,\r\n                ErrorCodes.NETWORK_ERROR,\r\n                error\r\n            );\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get provider list with stats\r\n     * Note: This would require additional data sources or indexing\r\n     * For now, returns empty array - implement with your preferred data source\r\n     */\r\n    async getProviders(options: {\r\n        sortBy?: 'apy' | 'totalStake' | 'rewardRate';\r\n        limit?: number;\r\n    } = {}): Promise<ProviderStats[]> {\r\n        // This would require:\r\n        // 1. Fetching provider list from VoterWhitelister contract\r\n        // 2. Getting stats from external APIs (flaremetrics.io, etc.)\r\n        // 3. Or indexing on-chain data\r\n\r\n        console.warn('getProviders() requires external data source - use flaremetrics.io API or similar');\r\n        return [];\r\n    }\r\n\r\n    /**\r\n     * Calculate potential rewards (estimate)\r\n     * @param amount Amount to delegate\r\n     * @param apy Annual percentage yield (default 12%)\r\n     * @param days Number of days\r\n     */\r\n    calculatePotentialRewards(amount: string, apy: number = 12, days: number = 365): string {\r\n        const amountNum = parseFloat(amount);\r\n        const rewards = amountNum * (apy / 100) * (days / 365);\r\n        return rewards.toFixed(4);\r\n    }\r\n}\r\n","import { Contract, JsonRpcProvider, parseEther, formatEther, formatUnits, TransactionResponse } from 'ethers';\r\nimport { FAssetsError, ErrorCodes } from '../../core/errors';\r\n\r\n// ABIs\r\nconst ASSET_MANAGER_ABI = [\r\n    'function reserveCollateral(address agent, uint256 lots) payable returns (uint256, uint256, uint64)',\r\n    'function redeem(uint256 lots, string memory redeemerUnderlyingAddressExecutor, address redeemer) payable returns (uint256, uint64)',\r\n    'function fAsset() view returns (address)',\r\n    'function lotSize() view returns (uint256)',\r\n    'function collateralReservationFee(uint256 lots) view returns (uint256)',\r\n    'function getAllAgents() view returns (address[])'\r\n];\r\n\r\nconst IERC20_ABI = [\r\n    'function balanceOf(address account) view returns (uint256)',\r\n    'function decimals() view returns (uint8)',\r\n    'function symbol() view returns (string)',\r\n    'function approve(address spender, uint256 amount) returns (bool)',\r\n    'function allowance(address owner, address spender) view returns (uint256)'\r\n];\r\n\r\nconst CONTRACT_REGISTRY_ABI = [\r\n    'function getContractAddressByName(string memory _name) external view returns (address)',\r\n];\r\n\r\n/**\r\n * fAssets Module\r\n * Bridge and mint synthetic assets on Flare\r\n */\r\nexport class FAssetsModule {\r\n    private provider: JsonRpcProvider;\r\n    private network: string;\r\n    private contractRegistryAddress: string;\r\n\r\n    constructor(provider: JsonRpcProvider, network: string) {\r\n        this.provider = provider;\r\n        this.network = network;\r\n        // FlareContractRegistry (same for all networks)\r\n        this.contractRegistryAddress = '0xaD67FE66660Fb8dFE9d6b1b4240d8650e30F6019';\r\n    }\r\n\r\n    /**\r\n     * Get AssetManager address from Registry\r\n     */\r\n    private async getAssetManagerAddress(symbol: string): Promise<string> {\r\n        try {\r\n            const contractRegistry = new Contract(\r\n                this.contractRegistryAddress,\r\n                CONTRACT_REGISTRY_ABI,\r\n                this.provider\r\n            );\r\n\r\n            // Naming convention: AssetManagerSymbol (e.g., AssetManagerFXRP)\r\n            // Remove underscore and uppercase the symbol\r\n            const name = `AssetManager${symbol.toUpperCase()}`;\r\n            const address = await contractRegistry.getContractAddressByName(name);\r\n\r\n            if (address === '0x0000000000000000000000000000000000000000') {\r\n                throw new Error(`AssetManager for ${symbol} not found`);\r\n            }\r\n\r\n            return address;\r\n        } catch (error: any) {\r\n            throw new FAssetsError(\r\n                `Failed to resolve AssetManager for ${symbol}: ${error.message}`,\r\n                ErrorCodes.NETWORK_ERROR,\r\n                error\r\n            );\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get fAsset Token address\r\n     */\r\n    private async getFAssetAddress(assetManagerAddress: string): Promise<string> {\r\n        const assetManager = new Contract(assetManagerAddress, ASSET_MANAGER_ABI, this.provider);\r\n        return await assetManager.fAsset();\r\n    }\r\n\r\n    /**\r\n     * Get fAsset balance\r\n     */\r\n    async getBalance(address: string, symbol: string): Promise<{ balance: string; decimals: number; symbol: string }> {\r\n        try {\r\n            const assetManagerAddress = await this.getAssetManagerAddress(symbol);\r\n            const fAssetAddress = await this.getFAssetAddress(assetManagerAddress);\r\n\r\n            const fAsset = new Contract(fAssetAddress, IERC20_ABI, this.provider);\r\n\r\n            const [balance, decimals, tokenSymbol] = await Promise.all([\r\n                fAsset.balanceOf(address),\r\n                fAsset.decimals(),\r\n                fAsset.symbol()\r\n            ]);\r\n\r\n            return {\r\n                balance: formatUnits(balance, decimals),\r\n                decimals: Number(decimals),\r\n                symbol: tokenSymbol,\r\n            };\r\n        } catch (error: any) {\r\n            throw new FAssetsError(\r\n                `Failed to get balance: ${error.message}`,\r\n                ErrorCodes.NETWORK_ERROR,\r\n                error\r\n            );\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get collateral requirements for minting\r\n     * @param symbol fAsset symbol (e.g. fXRP)\r\n     * @param lots Number of lots to mint\r\n     */\r\n    async getCollateralRequirements(symbol: string, lots: number): Promise<{ required: string; currency: string }> {\r\n        try {\r\n            const assetManagerAddress = await this.getAssetManagerAddress(symbol);\r\n            const assetManager = new Contract(assetManagerAddress, ASSET_MANAGER_ABI, this.provider);\r\n\r\n            const fee = await assetManager.collateralReservationFee(lots);\r\n\r\n            return {\r\n                required: formatEther(fee),\r\n                currency: 'FLR', // Collateral reservation fee is usually in native token (FLR/C2FLR)\r\n            };\r\n        } catch (error: any) {\r\n            throw new FAssetsError(\r\n                `Failed to get collateral requirements: ${error.message}`,\r\n                ErrorCodes.NETWORK_ERROR,\r\n                error\r\n            );\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Mint fAssets (Reserve Collateral)\r\n     * Note: This is Step 1 of minting. Step 2 requires paying underlying asset. Step 3 is executing minting.\r\n     * @param symbol fAsset symbol\r\n     * @param lots Number of lots to mint\r\n     * @param options { agent: string } Agent address to mint against\r\n     * @param signer Connected signer\r\n     */\r\n    async mint(symbol: string, lots: number, options: { agent: string }, signer: any): Promise<TransactionResponse> {\r\n        try {\r\n            const assetManagerAddress = await this.getAssetManagerAddress(symbol);\r\n            const assetManager = new Contract(assetManagerAddress, ASSET_MANAGER_ABI, signer);\r\n\r\n            const fee = await assetManager.collateralReservationFee(lots);\r\n\r\n            // reserveCollateral(agent, lots) payable\r\n            const tx = await assetManager.reserveCollateral(options.agent, lots, { value: fee });\r\n            return tx;\r\n        } catch (error: any) {\r\n            let message = error.message;\r\n            if (error.message.includes('Failed to fetch')) {\r\n                message = 'Network error: Please check your MetaMask connection and RPC URL.';\r\n            }\r\n            throw new FAssetsError(\r\n                `Failed to mint (reserve collateral): ${message}`,\r\n                ErrorCodes.TRANSACTION_FAILED,\r\n                error\r\n            );\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Redeem fAssets\r\n     * @param symbol fAsset symbol\r\n     * @param lots Number of lots to redeem\r\n     * @param options { to: string } Underlying address to receive assets\r\n     * @param signer Connected signer\r\n     */\r\n    async redeem(symbol: string, lots: number, options: { to: string }, signer: any): Promise<TransactionResponse> {\r\n        try {\r\n            const assetManagerAddress = await this.getAssetManagerAddress(symbol);\r\n            const assetManager = new Contract(assetManagerAddress, ASSET_MANAGER_ABI, signer);\r\n\r\n            // redeem(lots, redeemerUnderlyingAddressExecutor, redeemer) payable\r\n            // Note: Some implementations might require paying a redemption fee in native token\r\n            // We'll assume standard redemption for now.\r\n\r\n            const tx = await assetManager.redeem(lots, options.to, await signer.getAddress());\r\n            return tx;\r\n        } catch (error: any) {\r\n            let message = error.message;\r\n            if (error.message.includes('Failed to fetch')) {\r\n                message = 'Network error: Please check your MetaMask connection and RPC URL.';\r\n            }\r\n            throw new FAssetsError(\r\n                `Failed to redeem: ${message}`,\r\n                ErrorCodes.TRANSACTION_FAILED,\r\n                error\r\n            );\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get supported fAssets\r\n     * This is a helper that returns hardcoded list for now, as Registry enumeration is complex\r\n     */\r\n    async getSupportedAssets(): Promise<string[]> {\r\n        return ['fXRP', 'fBTC', 'fDOGE', 'fLTC', 'fALGO', 'fFIL'];\r\n    }\r\n\r\n    /**\r\n     * Get all available agents\r\n     */\r\n    async getAgents(symbol: string): Promise<string[]> {\r\n        try {\r\n            const assetManagerAddress = await this.getAssetManagerAddress(symbol);\r\n            const assetManager = new Contract(assetManagerAddress, ASSET_MANAGER_ABI, this.provider);\r\n            return await assetManager.getAllAgents();\r\n        } catch (error: any) {\r\n            throw new FAssetsError(\r\n                `Failed to get agents: ${error.message}`,\r\n                ErrorCodes.NETWORK_ERROR,\r\n                error\r\n            );\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get Lot Size\r\n     */\r\n    async getLotSize(symbol: string): Promise<string> {\r\n        try {\r\n            const assetManagerAddress = await this.getAssetManagerAddress(symbol);\r\n            const assetManager = new Contract(assetManagerAddress, ASSET_MANAGER_ABI, this.provider);\r\n            const size = await assetManager.lotSize();\r\n            // Lot size is usually in underlying decimals, but let's return as string\r\n            return size.toString();\r\n        } catch (error: any) {\r\n            throw new FAssetsError(\r\n                `Failed to get lot size: ${error.message}`,\r\n                ErrorCodes.NETWORK_ERROR,\r\n                error\r\n            );\r\n        }\r\n    }\r\n}\r\n","import { JsonRpcProvider } from 'ethers';\r\nimport { SDKError, ErrorCodes } from '../../core/errors';\r\n\r\n/**\r\n * State Connector Module\r\n * Verify state from any blockchain (advanced attestation)\r\n */\r\nexport class StateConnectorModule {\r\n    private provider: JsonRpcProvider;\r\n    private network: string;\r\n    private subscriptions: Map<string, NodeJS.Timeout> = new Map();\r\n\r\n    constructor(provider: JsonRpcProvider, network: string) {\r\n        this.provider = provider;\r\n        this.network = network;\r\n    }\r\n\r\n    /**\r\n     * Verify a state proof\r\n     */\r\n    async verify(params: {\r\n        proof: string;\r\n        attestationType: string;\r\n        sourceChain: string;\r\n    }): Promise<boolean> {\r\n        console.log('Verifying proof:', params);\r\n\r\n        // Mock verification\r\n        // In reality, this would call the StateConnector contract to verify the Merkle proof\r\n        await new Promise(resolve => setTimeout(resolve, 500));\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * Query state from another chain\r\n     */\r\n    async queryState(params: {\r\n        chain: string;\r\n        blockNumber: number;\r\n        address: string;\r\n    }): Promise<any> {\r\n        console.log('Querying state:', params);\r\n\r\n        // Mock response\r\n        return {\r\n            balance: '1000000',\r\n            nonce: 5,\r\n            codeHash: '0x123...',\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Get available attestation types\r\n     */\r\n    async getAttestationTypes(): Promise<string[]> {\r\n        return ['Payment', 'BalanceDecreasingTransaction', 'ConfirmedBlockHeightExists', 'ReferencedPaymentNonexistence'];\r\n    }\r\n\r\n    /**\r\n     * Get proof history\r\n     */\r\n    async getProofHistory(params: {\r\n        chain: string;\r\n        fromBlock: number;\r\n        limit?: number;\r\n    }): Promise<any[]> {\r\n        // Mock history\r\n        return [\r\n            {\r\n                proof: '0xabc...',\r\n                timestamp: new Date(),\r\n                verified: true,\r\n            },\r\n            {\r\n                proof: '0xdef...',\r\n                timestamp: new Date(Date.now() - 3600000),\r\n                verified: true,\r\n            }\r\n        ];\r\n    }\r\n\r\n    /**\r\n     * Subscribe to state updates\r\n     */\r\n    subscribe(chain: string, callback: (update: any) => void): () => void {\r\n        const timer = setInterval(() => {\r\n            callback({\r\n                chain,\r\n                timestamp: new Date(),\r\n                type: 'StateUpdate',\r\n                data: '0x...'\r\n            });\r\n        }, 15000);\r\n\r\n        this.subscriptions.set(chain, timer);\r\n\r\n        return () => {\r\n            clearInterval(timer);\r\n            this.subscriptions.delete(chain);\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Cleanup\r\n     */\r\n    cleanup(): void {\r\n        this.subscriptions.forEach(timer => clearInterval(timer));\r\n        this.subscriptions.clear();\r\n    }\r\n}\r\n","import { JsonRpcProvider } from 'ethers';\r\nimport type { SDKConfig, FlareNetwork } from '../types';\r\nimport { getNetworkConfig } from './networks';\r\nimport { SDKError, ErrorCodes } from './errors';\r\nimport { FTSOModule } from '../modules/ftso/FTSOModule';\r\nimport { WalletModule } from '../modules/wallet/WalletModule';\r\nimport { UtilsModule } from '../modules/utils/UtilsModule';\r\nimport { FDCModule } from '../modules/fdc/FDCModule';\r\nimport { StakingModule } from '../modules/staking/StakingModule';\r\nimport { FAssetsModule } from '../modules/fassets/FAssetsModule';\r\nimport { StateConnectorModule } from '../modules/stateConnector/StateConnectorModule';\r\n\r\n/**\r\n * Main FlareSDK class\r\n * Entry point for all SDK functionality\r\n */\r\nexport class FlareSDK {\r\n    private _provider: JsonRpcProvider | null = null;\r\n    private _network: FlareNetwork;\r\n    private _config: Required<SDKConfig>;\r\n    private _initialized = false;\r\n\r\n    // Modules\r\n    public ftso: FTSOModule;\r\n    public wallet: WalletModule;\r\n    public utils: UtilsModule;\r\n    public fdc: FDCModule;\r\n    public staking: StakingModule;\r\n    public fassets: FAssetsModule;\r\n    public stateConnector: StateConnectorModule;\r\n\r\n    constructor(config: SDKConfig = {}) {\r\n        // Set defaults\r\n        this._network = config.network || 'flare';\r\n        this._config = {\r\n            network: this._network,\r\n            rpcUrl: config.rpcUrl || getNetworkConfig(this._network).rpc,\r\n            provider: config.provider || null,\r\n            cacheEnabled: config.cacheEnabled ?? true,\r\n            cacheTTL: config.cacheTTL ?? 60,\r\n            debug: config.debug ?? false,\r\n        };\r\n\r\n        // Initialize provider\r\n        this._initializeProvider();\r\n\r\n        // Initialize modules\r\n        this.ftso = new FTSOModule(this.provider, this._network, this._config.cacheTTL);\r\n        this.wallet = new WalletModule();\r\n        this.utils = new UtilsModule();\r\n        this.fdc = new FDCModule(this.provider, this._network);\r\n        this.staking = new StakingModule(this.provider, this._network);\r\n        this.fassets = new FAssetsModule(this.provider, this._network);\r\n        this.stateConnector = new StateConnectorModule(this.provider, this._network);\r\n    }\r\n\r\n    /**\r\n     * Initialize the RPC provider\r\n     */\r\n    private _initializeProvider(): void {\r\n        try {\r\n            if (this._config.provider) {\r\n                this._provider = this._config.provider;\r\n            } else {\r\n                this._provider = new JsonRpcProvider(this._config.rpcUrl);\r\n            }\r\n\r\n            this._initialized = true;\r\n\r\n            if (this._config.debug) {\r\n                console.log(`[FlareSDK] Connected to ${this._network}`);\r\n            }\r\n        } catch (error) {\r\n            throw new SDKError(\r\n                'Failed to initialize provider',\r\n                ErrorCodes.NETWORK_ERROR,\r\n                error\r\n            );\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get the current provider\r\n     */\r\n    get provider(): JsonRpcProvider {\r\n        if (!this._provider || !this._initialized) {\r\n            throw new SDKError(\r\n                'SDK not initialized',\r\n                ErrorCodes.NOT_INITIALIZED\r\n            );\r\n        }\r\n        return this._provider;\r\n    }\r\n\r\n    /**\r\n     * Get the current network\r\n     */\r\n    get network(): FlareNetwork {\r\n        return this._network;\r\n    }\r\n\r\n    /**\r\n     * Get the network configuration\r\n     */\r\n    get networkConfig() {\r\n        return getNetworkConfig(this._network);\r\n    }\r\n\r\n    /**\r\n     * Check if SDK is initialized\r\n     */\r\n    get isInitialized(): boolean {\r\n        return this._initialized;\r\n    }\r\n\r\n    /**\r\n     * Get SDK configuration\r\n     */\r\n    get config(): Readonly<Required<SDKConfig>> {\r\n        return this._config;\r\n    }\r\n\r\n    /**\r\n     * Switch to a different network\r\n     */\r\n    async switchNetwork(network: FlareNetwork): Promise<void> {\r\n        if (network === this._network) {\r\n            return;\r\n        }\r\n\r\n        this._network = network;\r\n        this._config.network = network;\r\n        this._config.rpcUrl = getNetworkConfig(network).rpc;\r\n\r\n        // Reinitialize provider\r\n        this._initializeProvider();\r\n\r\n        // Reinitialize modules with new provider\r\n        this.ftso = new FTSOModule(this.provider, this._network, this._config.cacheTTL);\r\n\r\n        if (this._config.debug) {\r\n            console.log(`[FlareSDK] Switched network to ${network}`);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Disconnect and cleanup\r\n     */\r\n    disconnect(): void {\r\n        // Cleanup modules\r\n        this.ftso.cleanup();\r\n\r\n        this._provider = null;\r\n        this._initialized = false;\r\n\r\n        if (this._config.debug) {\r\n            console.log('[FlareSDK] Disconnected');\r\n        }\r\n    }\r\n}\r\n"]}